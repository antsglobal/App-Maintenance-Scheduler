{"ast":null,"code":"import { ReplaySubject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/assett-racking.service\";\nimport * as i2 from \"../../helpers/asset-helpers\";\n\nfunction AssetSummaryComponent_mat_card_content_4_div_23_tr_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\", 27);\n    i0.ɵɵelementStart(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const asset_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", asset_r3.AssetName, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", asset_r3.AssetCount, \" \");\n  }\n}\n\nfunction AssetSummaryComponent_mat_card_content_4_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 19);\n    i0.ɵɵelementStart(1, \"div\", 20);\n    i0.ɵɵelementStart(2, \"div\", 21);\n    i0.ɵɵelementStart(3, \"div\", 21);\n    i0.ɵɵelementStart(4, \"div\", 22);\n    i0.ɵɵelementStart(5, \"div\", 23);\n    i0.ɵɵelementStart(6, \"h2\", 24);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"table\", 25);\n    i0.ɵɵelementStart(9, \"tbody\");\n    i0.ɵɵtemplate(10, AssetSummaryComponent_mat_card_content_4_div_23_tr_10_Template, 5, 2, \"tr\", 26);\n    i0.ɵɵelementStart(11, \"tr\", 27);\n    i0.ɵɵelementStart(12, \"td\");\n    i0.ɵɵtext(13, \"Total Devices\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"td\");\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"div\", 28);\n    i0.ɵɵelementStart(17, \"a\", 29);\n    i0.ɵɵtext(18, \"Devices Info \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r1.activeLocationName, \" Devices Info \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.locationAssetsList);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.totalAsssetsInLocation, \" \");\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    \"active\": a0\n  };\n};\n\nfunction AssetSummaryComponent_mat_card_content_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"mat-card-content\", 4);\n    i0.ɵɵelementStart(1, \"div\", 5);\n    i0.ɵɵelementStart(2, \"div\", 6);\n    i0.ɵɵelementStart(3, \"div\", 7);\n    i0.ɵɵelementStart(4, \"div\", 8);\n    i0.ɵɵelementStart(5, \"div\", 9);\n    i0.ɵɵlistener(\"click\", function AssetSummaryComponent_mat_card_content_4_Template_div_click_5_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.getAssetsListByLocation(5);\n    });\n    i0.ɵɵelementStart(6, \"span\", 10);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(8, \"img\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 9);\n    i0.ɵɵlistener(\"click\", function AssetSummaryComponent_mat_card_content_4_Template_div_click_9_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.getAssetsListByLocation(2);\n    });\n    i0.ɵɵelementStart(10, \"span\", 10);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(12, \"img\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"div\", 9);\n    i0.ɵɵlistener(\"click\", function AssetSummaryComponent_mat_card_content_4_Template_div_click_13_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.getAssetsListByLocation(3);\n    });\n    i0.ɵɵelementStart(14, \"span\", 10);\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(16, \"img\", 12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"div\", 13);\n    i0.ɵɵlistener(\"click\", function AssetSummaryComponent_mat_card_content_4_Template_div_click_17_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return ctx_r8.getAssetsListByLocation(4);\n    });\n    i0.ɵɵelementStart(18, \"span\", 14);\n    i0.ɵɵtext(19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(20, \"img\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"div\", 16);\n    i0.ɵɵelement(22, \"img\", 17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(23, AssetSummaryComponent_mat_card_content_4_div_23_Template, 19, 3, \"div\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(9, _c0, ctx_r0.activeLocationId == 5));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.getLocationAssetCount(5));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(11, _c0, ctx_r0.activeLocationId == 2));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.getLocationAssetCount(2));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(13, _c0, ctx_r0.activeLocationId == 3));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.getLocationAssetCount(3));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(15, _c0, ctx_r0.activeLocationId == 4));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.getLocationAssetCount(4));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.displayAssetLocations);\n  }\n}\n\nexport let AssetSummaryComponent = /*#__PURE__*/(() => {\n  class AssetSummaryComponent {\n    constructor(assetservice, _assetHelper) {\n      this.assetservice = assetservice;\n      this._assetHelper = _assetHelper;\n      this.destroyed$ = new ReplaySubject(1);\n      this.fetchData = false;\n      this.displayAssetLocations = false;\n      this.refreshData = false;\n      this.locationsSub = this.assetservice.getAssetLocations().pipe(takeUntil(this.destroyed$)).subscribe(data => {\n        this.locations = data;\n      });\n      this.asssetCountByLocationSub = this.assetservice.getAssetCountByLocation().pipe(takeUntil(this.destroyed$)).subscribe(data => {\n        this.asssetCountByLocation = data;\n      }); // this.getAssetCounts();\n\n      this.locationImagesSub = this.assetservice.getLocationsImages().pipe(takeUntil(this.destroyed$)).subscribe(data => {\n        this.locationImages = data;\n        this.fetchData = true;\n      });\n    }\n\n    ngOnInit() {\n      // this.getAssetCounts()\n      this.refreshData = true;\n      this.autoRefersh();\n    }\n\n    getAssetCounts() {\n      this.assetservice.getAssetCountByLocation().pipe(takeUntil(this.destroyed$)).subscribe(data => {\n        this.asssetCountByLocation = data;\n      });\n    }\n\n    autoRefersh() {\n      if (this.refreshData) setTimeout(() => {\n        this.getAssetsListByLocation(this.activeLocationId);\n        this.getAssetCounts();\n        this.autoRefersh();\n      }, 15000);\n    }\n\n    getAssetsListByLocation(locationId = 0) {\n      if (this.activeLocationId != locationId && !this.displayAssetLocations) this.displayAssetLocations = false;\n\n      if (locationId > 0) {\n        this.activeLocationId = locationId;\n        this.activeLocationName = this.getLocationNameById(locationId).locationDescription.replace(/_/g, \" \");\n        this.assetDataSub = this.assetservice.getlocationAssetDetails(locationId).pipe(takeUntil(this.destroyed$)).subscribe(data => {\n          let assetData = this._assetHelper.assetsByLocation(data);\n\n          this.locationAssetsList = assetData.data;\n          this.totalAsssetsInLocation = assetData.totalCount;\n          this.displayAssetLocations = true;\n        });\n      }\n    }\n\n    getLocationNameById(locationId) {\n      return this.locations.find(location => {\n        return location.locationId == locationId;\n      });\n    }\n\n    getLocationImage(locationId) {\n      this.locationImages.find(item => item.locationId == locationId);\n    }\n\n    getLocationAssetCount(id) {\n      let item;\n      if (this.asssetCountByLocation) item = this.asssetCountByLocation.find(item => item.LocationId == id);\n      return item && item.AssetCount ? item.AssetCount : 0;\n    }\n\n    ngOnDestroy() {\n      this.refreshData = false;\n\n      if (this.locationsSub) {\n        this.locationsSub.unsubscribe();\n      }\n\n      if (this.asssetCountByLocationSub) {\n        this.asssetCountByLocationSub.unsubscribe();\n      }\n\n      if (this.assetDataSub) {\n        this.assetDataSub.unsubscribe();\n      }\n\n      if (this.locationImagesSub) {\n        this.locationImagesSub.unsubscribe();\n      }\n\n      this.destroyed$.next(true);\n      this.destroyed$.complete();\n    }\n\n  }\n\n  AssetSummaryComponent.ɵfac = function AssetSummaryComponent_Factory(t) {\n    return new (t || AssetSummaryComponent)(i0.ɵɵdirectiveInject(i1.AssettRackingService), i0.ɵɵdirectiveInject(i2.AssetHelper));\n  };\n\n  AssetSummaryComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AssetSummaryComponent,\n    selectors: [[\"app-asset-summary\"]],\n    decls: 6,\n    vars: 1,\n    consts: [[1, \"mat-card-page\"], [1, \"mat-card-header-page\"], [1, \"mat-card-title-page\"], [\"class\", \"mat-card-content-page p-20\", 4, \"ngIf\"], [1, \"mat-card-content-page\", \"p-20\"], [1, \"row\", \"pt-4\"], [1, \"col-md-8\"], [1, \"asset_floor_plan\"], [1, \"row\", \"px-5\", \"pb-4\"], [1, \"col-md-4\", \"m-0\", \"p-0\", \"item\", \"cursor-pointer\", 3, \"click\"], [1, \"notify-badge\", 3, \"ngClass\"], [\"src\", \"../../../assets/images/room-1.png\", \"width\", \"100%\"], [\"src\", \"../../../assets/images/room-2.png\", \"width\", \"100%\"], [1, \"col-md-3\", \"m-0\", \"p-0\", \"item\", \"cursor-pointer\", 3, \"click\"], [1, \"notify-badge\", \"top40\", 3, \"ngClass\"], [\"src\", \"../../../assets/images/room-4.png\", \"width\", \"100%\", \"height\", \"80%\"], [1, \"col-md-9\", \"m-0\", \"p-0\"], [\"src\", \"../../../assets/images/room-5.png\", \"width\", \"100%\"], [\"class\", \"col-md-4\", 4, \"ngIf\"], [1, \"col-md-4\"], [1, \"card-event\", \"card\", \"border\"], [1, \"card-body\", \"border-left\"], [1, \"row\", \"align-items-center\", \"justify-content-center\"], [1, \"col\"], [1, \"m-0\"], [\"width\", \"100%\", \"cellspacing\", \"0\", \"role\", \"grid\", \"aria-describedby\", \"dataTable_info\", 1, \"table\", \"table-bordered\", \"dataTable\", 2, \"width\", \"100%\"], [\"role\", \"row\", \"class\", \"odd\", 4, \"ngFor\", \"ngForOf\"], [\"role\", \"row\", 1, \"odd\"], [1, \"text-muted\", \"mt-3\", \"mb-0\"], [\"href\", \"#\", \"data-toggle\", \"modal\", \"data-target\", \"#exampleModal\", 1, \"devices-info\", \"text-white\"]],\n    template: function AssetSummaryComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"mat-card\", 0);\n        i0.ɵɵelementStart(1, \"mat-card-header\", 1);\n        i0.ɵɵelementStart(2, \"mat-card-title\", 2);\n        i0.ɵɵtext(3, \" Asset Summary \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(4, AssetSummaryComponent_mat_card_content_4_Template, 24, 17, \"mat-card-content\", 3);\n        i0.ɵɵelement(5, \"mat-card-footer\");\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", ctx.fetchData);\n      }\n    },\n    styles: [\"\"]\n  });\n  return AssetSummaryComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}